---
type Props = {
  slug: string;
  title: string;
  description: string;
  status: string;
  tech: string[];
  tags: string[];
  repo: string;
};

const { slug, title, description, status, tech, tags, repo } = Astro.props;
const initialTags = tags.slice(0, 2);
const hiddenTags = tags.slice(2);
---

<article data-card>
  <header>
    <a href={`/projects/${slug}`}>
      <h3>{title}</h3>
    </a>
    <span class="status">{status}</span>
  </header>
  <p>{description}</p>
  {
    tech.length > 0 && (
      <div class="tech-stack">
        <span class="label">Tech:</span>
        {tech.map((t) => (
          <span class="badge">{t}</span>
        ))}
      </div>
    )
  }

  {
    tags.length > 0 && (
      <div class="categories" data-expanded="false">
        {initialTags.map((tag) => (
          <span class="category">{tag}</span>
        ))}
        {hiddenTags.map((tag) => (
          <span class="category is-hidden" data-hidden>
            {tag}
          </span>
        ))}
        {hiddenTags.length > 0 && (
          <button type="button" class="category toggle" data-toggle aria-expanded="false">
            <span aria-hidden="true">...</span>
            <span class="sr-only">Show all tags</span>
          </button>
        )}
      </div>
    )
  }
  <footer>
    <a href={repo} target="_blank" rel="noopener noreferrer" class="repo-link"> View on GitHub â†’ </a>
  </footer>
</article>

<script>
  import { setupTagToggles } from "$utils/tag-toggle";
  setupTagToggles();
</script>

<style>
  @reference "../styles/global.css";

  .tech-stack {
    @apply flex items-center gap-2 flex-wrap mb-1 px-6 py-2;
  }

  .tech-stack .label {
    @apply text-muted text-sm font-semibold;
  }

  .tech-stack .badge {
    background: color-mix(in oklab, var(--panel), black 12%);
    @apply text-cyan px-2.5 py-1 rounded-sm text-xs border border-line;
  }

  [data-card] footer {
    @apply px-5 py-4 mt-2 border-t border-dotted border-line;
  }

  [data-card] footer a {
    @apply text-muted text-sm;
    @apply duration-200 hover:underline hover:text-cyan;
  }
</style>
